# VeChain grant research proposal template

## Phalanx: a practical order-fairness byzantine consensus protocol

## Applicants

Guangren Wang (corresponding applicant). He is currently a second-year Master student at Collage of Computer Science and Technology, Zhejiang University. His research interests lie in distributed systems, especially blockchain systems. Most recently, he has been focusing on building efficient and high-performance permissioned blockchain system at [Hangzhou Qulian Technology](https://www.hyperchain.cn/) as a research intern.

Fangyu Gai. He is currently a third-year Ph.D. student at School of Engineering, University of British Columbia, supervised by [Dr. Chen Feng](https://people.ok.ubc.ca/cfeng01/index.html), who is the co-cluster lead of [Blockchain@UBC](https://blockchain.ubc.ca/). His research interests lie in distributed systems, especially blockchain systems. Most recently, He has been focusing on building efficient and high-performance permissioned blockchain databases at [Alibaba DAMO Academy](https://damo.alibaba.com/) as a research intern. More information including his CV can be found at his [website](https://fangyugai.me/).


## Payment Address
USDT (ERC-20): 0x4D040d436116D20b13Ff23C7b514E9d57d84b37c

## Summary

 We proposed a brand-new protocol called *Phalanx*. It is an order-fairness byzantine protocol to achieve *order-fairness* property, which is a new kind of BFT property, indicating a trusted order for transactions, introduced by [[4]](#refer-anchor-4). It could become a plugin for most kinds of BFT, which means a traditional protocol, such as PBFT or HotStuff, could complete the *order-fairness* property easily with the accession of *Phalanx*. In addition, *Phalanx* could also be used in asynchronous situation, we would like to propose an asynchronous byzantine protocol, called *Async-Phalanx*, to achieve it.

### Main field of research

Blockchain consensus mechanisms / Blockchain security / privacy

### Keywords

Byzantine fault-tolerant, blockchain consensus, order-fairness

## Research proposal

### Background

Generally, a BFT (*Byzantine Fault Tolerance*) consensus algorithm concentrates on two properties, *safety* and *liveness*. Well, in the system on reality, we should also pay attention to the order of transactions, in which an incorrect order may make the tasks failed. For instance, here is an instant commodity trading system. In such a system, we should send a *trading-transaction* for it if we would like to buy something. After the process of this transaction, the commodity you prefer would be locked. When only one consumer is trying to buy one commodity and sending *trading-transaction*, it is easy to process.  But if there are several people trying to buy one thing at the same time, a concurrency problem will occur, and the order of trading-transactions* could decide who the commodity belongs to. In this situation, the order of transactions would be important for trading fairness.

With most BFT algorithm, especially the partially synchronous protocols, such as PBFT[[1]](#refer-anchor-1) [[2]](#refer-anchor-2) and HotStuff[[3]](#refer-anchor-3), we cannot deal with the problem about fairness of transaction order because of the proposal generation process. In most BFT protocols, a proposal is usually generated by one specific node, and the participants could only detect limited malicious manners of proposer, such as *fork-attack* or *silence-attack*. As the proposer could make a decision on the content of proposals, it could decide the order the transactions on purpose to make some of them failed, which cannot be detected as normal.

So that, in *CRYPTO2020*, [[4]](#refer-anchor-4) introduced a new kind of property for BFT called *order-fairness*, which indicates a trusted order for transactions. The author has also proposed a new class of consensus protocols called Aequitas, which are the first to achieve *order-fairness* in both *synchronous* and *asynchronous* situations.  However, the Aequitas are difficult to implement, and there are not any experiments for the performance of them. To make it more practical, in *USENIX2020*, [[5]](#refer-anchor-5) proposed a consensus protocolcalled Pompe, which could also achieve the *order-fairness* under the partially synchronous BFT protocols, and did some experiments on it. But it is difficult for us to use Pompe in asynchronous situation, as the order of commands in it is decided by *trusted-timestamp*.

### Contributions

So that, we propose a brand-new protocol called *Phalanx*. It is an order-fairness byzantine fault tolerance protocol to achieve *order-fairness* property. It could become a plugin for most kinds of BFT protocol, which means a traditional BFT protocol could complete the *order-fairness* property easily with the accession of *Phalanx*. In addition, the *Phalanx* protocol could also be used in asynchronous situation, we would like to propose an asynchronous byzantine fault tolerance protocol, called *Async-Phalanx*, to achieve it.

### Problem Statement

We have finished the basic implement for *Phalanx* protocol in a private repository, and now we are trying to do more experiment on *Phalanx* to make it more practical. In this project, we plan to improve it in the following three stages:

1. Write a scientific paper, potentially working with the Vechain research team to make it more friendly to Vechain's ecosystem.
2. Complete the asynchronous order-fairness protocol *Async-Phalanx* and test the performance and other properties.
3. Consider to apply it into Vechain's ecosystem.

### Reference

<div id="refer-anchor-1"></div>
[1] Castro M, Liskov B. Practical byzantine fault tolerance[C]//OSDI. 1999, 99(1999): 173-186.

<div id="refer-anchor-2"></div>
[2] Castro M, Liskov B. Practical Byzantine fault tolerance and proactive recovery[J]. ACM Transactions on Computer Systems (TOCS), 2002, 20(4): 398-461.

<div id="refer-anchor-3"></div>
[3] Yin M, Malkhi D, Reiter M K, et al. Hotstuff: Bft consensus with linearity and responsiveness[C]//Proceedings of the 2019 ACM Symposium on Principles of Distributed Computing. 2019: 347-356.

<div id="refer-anchor-4"></div>
[4] Kelkar M, Zhang F, Goldfeder S, et al. Order-fairness for byzantine consensus[C]//Annual International Cryptology Conference. Springer, Cham, 2020: 451-480.

<div id="refer-anchor-5"></div>
[5] Zhang Y, Setty S, Chen Q, et al. Byzantine Ordered Consensus without Byzantine Oligarchy[C]//14th {USENIX} Symposium on Operating Systems Design and Implementation ({OSDI} 20). 2020: 633-649.

### Milestones

#### Overview

|  | Milestone 1 | Milestone 2 |  Milestone 3 | Total |
| - | - |- | - | - |
| Estimated Duration | 60 d | 60 d | 60 d | 180 d |
| Full-time equivalent (FTE) | 0.5 | 0.5 | 0.5 | 1.5 |
| Cost (up to $ 30,000) | $ 5,000 | $ 5,320 | $ 5,320 | $15,640 |

#### Milestone 1 — Scientific paper

| Number | Deliverable | Specification |
|-|-|-|
| 0 | Techinical Report | We will finished a technical report and make sure it is well-written and technically correct; the output should be a techinical report publicly available on [arXiv](https://arxiv.org/) and potentially submitted to some academic conference or journal |

#### Milestone 2  —  Prototype
| Number | Deliverable | Specification |
|-|-|-|
| 0 | Open-sourced Demo | We will build a prototype of our protocol using Golang; the output should be a open-sourced repo on [github.com](https://github.com/) that is implemented following the specification of the technical report from Milestone 1 and have cloud-deployment abilities |

#### Milestone 3  —  Application
| Number | Deliverable | Specification |
|-|-|-|
| 0 | Integrated Blockchain Platform | We will consider its application for Vechain's ecosystem; the output should be production-level code integrated into an existing blockchain platform |

## Budget

The budgest mainly consists of human resources and cloud facilities.

According to UBC's latest teaching assistant [pay rate](https://cupe2278.ca/how-we-help/pay-rates/), a Ph.D. student is paid at the level of GTA I, which is 34.44 CAD (around 29 USD) per hour. For each milestone, we have 60 days, which is 8.5 weeks, counting to 8.5 (weeks) * 40 (total work hours per week) * 0.5 (FTE) = 170 h. Therefore, the budget for human resources is 170 * 29 = 4,930, which is up to 5k USD.

As for the cloud deployment facilities that will be used in Milestone 2 and 3, the budget is calculated based on the hourly price of AWS's EC2 [instance a1.xlarge](https://aws.amazon.com/ec2/pricing/on-demand/):
0.1 (hourly price) * 32 (instance number) * 100 (expected hours) = 320 USD.
